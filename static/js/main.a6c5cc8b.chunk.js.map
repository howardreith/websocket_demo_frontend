{"version":3,"sources":["ContextProvider.js","withAppContext.js","components/backend.js","helpers/PropTypeConstants.js","components/SignupPage.js","components/ChatRoom.js","components/LandingPage.js","App.js","index.js"],"names":["AppContext","React","createContext","ContextProvider","props","_this","state","token","username","setToken","cb","setState","setUsername","children","this","Provider","value","Component","withAppContext","Consumer","appContext","backendUrl","PropTypes","shape","push","func","string","process","signInWithUsername","a","fetch","method","headers","Accept","body","JSON","stringify","result","json","messages","getLast50Messages","StyledAuthFormWrapper","styled","div","StyledSignUpFormHeading","h1","StyledAuthInputWrapper","StyledSignUpFormInputField","input","StyledAuthFormSubmitButton","button","handleSubmitAsync","bind","handleUsernameChange","event","target","preventDefault","onHandleSubmitUsername","onSubmit","type","name","id","onChange","placeholder","socket","io","StyledChatRoom","StyledMessageTextBox","textarea","StyledSendButton","StyledMessageTextForm","form","StyledHeaderWrapper","handleMessageTextChange","onKeyDown","messageText","messagesEndRef","createRef","initialMessages","reverse","on","data","message","messageSender","scrollToBottom","emit","key","stopPropagation","current","scrollIntoView","behavior","map","i","replace","ref","handleSubmitUsername","ChatRoom","App","exact","path","render","landingPageProps","ReactDOM","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.a6c5cc8b.chunk.js","sourcesContent":["import React, { Component } from 'react';\nimport * as PropTypes from 'prop-types';\n\nexport const AppContext = React.createContext(null, null);\n\nexport function buildState(_this) {\n  return {\n    token: null,\n    username: null,\n\n    setToken: (token, cb) => {\n      _this.setState((state) => ({ ...state, token }), cb);\n    },\n\n    setUsername: (username, cb) => {\n      _this.setState((state) => ({ ...state, username }), cb);\n    },\n  };\n}\n\nexport default class ContextProvider extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = buildState(this);\n  }\n\n  render() {\n    const { children } = this.props;\n    return (\n      <AppContext.Provider value={this.state}>\n        {children}\n      </AppContext.Provider>\n    );\n  }\n}\n\nContextProvider.propTypes = {\n  children: PropTypes.oneOfType([\n    PropTypes.arrayOf(PropTypes.node),\n    PropTypes.node,\n  ]).isRequired,\n};\n","import React from 'react';\nimport { AppContext } from './ContextProvider';\n\nexport default function withAppContext(Component) {\n  return function WrapperComponent(props) {\n    return (\n      <AppContext.Consumer>\n        {(state) => <Component {...props} appContext={state} />}\n      </AppContext.Consumer>\n    );\n  };\n}\n","const backendUrl = process.env.REACT_APP_BACKEND_URL;\n\nexport async function signInWithUsername(username) {\n  const result = await fetch(`${backendUrl}/signin`, {\n    method: 'post',\n    headers: {\n      Accept: 'application/json',\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify({\n      username,\n    }),\n  });\n  return result.json().messages;\n}\n\nexport async function getLast50Messages() {\n  const result = await fetch(`${backendUrl}/last50messages`, {\n    method: 'get',\n  });\n  return result.json();\n}\n","import PropTypes from 'prop-types';\n\nexport const HistoryPropType = PropTypes.shape({\n  push: PropTypes.func,\n});\n\nexport const AppContextPropType = PropTypes.shape({\n  token: PropTypes.string,\n  username: PropTypes.string,\n  setToken: PropTypes.func,\n  setUsername: PropTypes.func,\n});\n","import React, { Component } from 'react';\nimport * as PropTypes from 'prop-types';\nimport styled from 'styled-components';\nimport withAppContext from '../withAppContext';\n\nexport const StyledAuthFormWrapper = styled.div`\n  margin: auto;\n  text-align: center;\n  width: 60%;\n`;\n\nexport const StyledSignUpFormHeading = styled.h1`\n  font-family: \"Arvo\", serif;\n  font-size: 40px;\n`;\n\nexport const StyledAuthInputWrapper = styled.div`\n  margin: 10px auto;\n  text-align: center;\n`;\n\nexport const StyledSignUpFormInputField = styled.input`\n  height: 30px;\n  width: 80%;\n  display: block;\n  margin: auto;\n  text-align: center;\n  font-size: 20px;\n`;\n\nexport const StyledAuthFormSubmitButton = styled.button`\n  transition-duration: 0.4s;\n  background-color: white;\n  color: black;\n  border-color: gray;\n  height: 25px;\n  cursor: pointer;\n  margin: 2px;\n  font-family: \"Lato\", serif;\n`;\n\nclass SignupPage extends Component {\n  constructor(props) {\n    super(props);\n\n    this.handleSubmitAsync = this.handleSubmitAsync.bind(this);\n    this.handleUsernameChange = this.handleUsernameChange.bind(this);\n\n    this.state = { username: null };\n  }\n\n  handleUsernameChange(event) {\n    const { value } = event.target;\n    this.setState((state) => ({ ...state, username: value }));\n  }\n\n  async handleSubmitAsync(event) {\n    const { username } = this.state;\n    event.preventDefault();\n    const { onHandleSubmitUsername } = this.props;\n    onHandleSubmitUsername(username);\n  }\n\n  render() {\n    return (\n      <>\n        <StyledAuthFormWrapper>\n          <StyledSignUpFormHeading>Choose a Username</StyledSignUpFormHeading>\n          <form onSubmit={this.handleSubmitAsync}>\n            <StyledAuthInputWrapper>\n              <StyledSignUpFormInputField\n                type=\"text\"\n                name=\"username\"\n                id=\"usernameInput\"\n                onChange={this.handleUsernameChange}\n                placeholder=\"Username\"\n              />\n            </StyledAuthInputWrapper>\n            <StyledAuthFormSubmitButton type=\"submit\" value=\"submit\" id=\"usernameSubmitButton\">\n              Submit\n            </StyledAuthFormSubmitButton>\n          </form>\n        </StyledAuthFormWrapper>\n      </>\n    );\n  }\n}\n\nexport default withAppContext(SignupPage);\n\nSignupPage.propTypes = {\n  onHandleSubmitUsername: PropTypes.func.isRequired,\n};\n","/* eslint-disable react/no-array-index-key */\nimport React, { Component } from 'react';\nimport { io } from 'socket.io-client';\nimport styled from 'styled-components';\nimport { getLast50Messages } from './backend';\nimport withAppContext from '../withAppContext';\nimport { AppContextPropType } from '../helpers/PropTypeConstants';\n\nconst backendUrl = process.env.REACT_APP_BACKEND_URL;\nconst socket = io(backendUrl);\n\nexport const StyledChatRoom = styled.div`\n  margin: 3px;\n  width: 99%;\n  border: 1px solid black;\n  max-height: 85vh;\n  overflow: scroll;\n`;\n\nexport const StyledMessageTextBox = styled.textarea`\n  margin: 3px;\n  width: 100%;\n  display: flex;\n  height: 30px;\n`;\n\nexport const StyledSendButton = styled.input`\n  width: 70px;\n  height: 35px;\n  margin: 3px;\n`;\n\nexport const StyledMessageTextForm = styled.form`\n  display: flex;\n`;\n\nexport const StyledHeaderWrapper = styled.div`\n  height: 60px;\n  text-align: center;\n`;\n\nexport class ChatRoomWithoutContext extends Component {\n  constructor(props) {\n    super(props);\n    this.handleMessageTextChange = this.handleMessageTextChange.bind(this);\n    this.handleSubmitAsync = this.handleSubmitAsync.bind(this);\n    this.onKeyDown = this.onKeyDown.bind(this);\n\n    this.state = { messageText: '', messages: [] };\n    this.messagesEndRef = React.createRef();\n  }\n\n  async componentDidMount() {\n    const initialMessages = await getLast50Messages();\n    this.setState({ messages: initialMessages.messages.reverse() });\n\n    socket.on('receiveMessage', (data) => {\n      const { username, message } = data;\n      const { messages } = this.state;\n      messages.push({ messageSender: username, message });\n      this.setState({ messages });\n    });\n  }\n\n  componentDidUpdate() {\n    this.scrollToBottom();\n  }\n\n  handleMessageTextChange(event) {\n    const { value } = event.target;\n    this.setState((state) => ({ ...state, messageText: value }));\n  }\n\n  async handleSubmitAsync(event) {\n    event.preventDefault();\n    const { messageText } = this.state;\n    const { appContext } = this.props;\n    const data = { username: appContext.username, message: messageText };\n    socket.emit('message', data);\n    this.setState({ messageText: '' });\n  }\n\n  async onKeyDown(event) {\n    if (event.key === 'Enter') {\n      event.preventDefault();\n      event.stopPropagation();\n      await this.handleSubmitAsync(event);\n    }\n  }\n\n  scrollToBottom() {\n    this.messagesEndRef.current.scrollIntoView({ behavior: 'smooth' });\n  }\n\n  render() {\n    const { messageText, messages } = this.state;\n    return (\n      <div>\n        <StyledHeaderWrapper>\n          <h1>Howie Chat</h1>\n        </StyledHeaderWrapper>\n        <StyledChatRoom>\n          {messages.map((message, i) => (\n            <div key={`${i}wrapper${message.message.replace(/\\s/, '')}`}>\n              <span key={`${i}sender${message.message.replace(/\\s/, '')}`}>\n                {`${message.messageSender}: `}\n              </span>\n              <span key={`${i}message${message.message.replace(/\\s/, '')}`}>{message.message}</span>\n            </div>\n          ))}\n          <div ref={this.messagesEndRef} />\n        </StyledChatRoom>\n        <StyledMessageTextForm onSubmit={this.handleSubmitAsync}>\n          <StyledMessageTextBox\n            onKeyDown={this.onKeyDown}\n            value={messageText}\n            onChange={this.handleMessageTextChange}\n          />\n          <StyledSendButton type=\"submit\" value=\"send\" id=\"sendMessageButton\" />\n        </StyledMessageTextForm>\n      </div>\n    );\n  }\n}\n\nexport default withAppContext(ChatRoomWithoutContext);\n\nChatRoomWithoutContext.propTypes = {\n  appContext: AppContextPropType.isRequired,\n};\n","import React, { Component } from 'react';\nimport withAppContext from '../withAppContext';\nimport { AppContextPropType } from '../helpers/PropTypeConstants';\nimport { signInWithUsername } from './backend';\nimport SignupPage from './SignupPage';\nimport ChatRoom from './ChatRoom';\n\nclass LandingPage extends Component {\n  constructor(props) {\n    super(props);\n\n    this.handleSubmitUsername = this.handleSubmitUsername.bind(this);\n  }\n\n  async handleSubmitUsername(username) {\n    const { appContext } = this.props;\n    await signInWithUsername(username);\n    appContext.setUsername(username);\n  }\n\n  render() {\n    const { appContext } = this.props;\n    return (\n      <>\n        {!appContext.username && <SignupPage onHandleSubmitUsername={this.handleSubmitUsername} />}\n        {appContext.username && <ChatRoom />}\n      </>\n\n    );\n  }\n}\n\nexport default withAppContext(LandingPage);\n\nLandingPage.propTypes = {\n  appContext: AppContextPropType.isRequired,\n};\n","import React, { Component } from 'react';\nimport { BrowserRouter, Route } from 'react-router-dom';\nimport ContextProvider, { AppContext } from './ContextProvider';\nimport LandingPage from './components/LandingPage';\n\nfunction renderApplication() {\n  return (\n    <>\n      <BrowserRouter>\n        <Route\n          exact\n          path=\"/\"\n          render={(landingPageProps) => (<LandingPage {...landingPageProps} />)}\n        />\n      </BrowserRouter>\n    </>\n  );\n}\n\nclass App extends Component {\n  render() {\n    return (\n      <ContextProvider>\n        <AppContext.Consumer>\n          {\n            (appContext) => {\n              if (appContext) {\n                return renderApplication();\n              }\n              return <></>;\n            }\n          }\n        </AppContext.Consumer>\n      </ContextProvider>\n    );\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root'),\n);\n"],"sourceRoot":""}