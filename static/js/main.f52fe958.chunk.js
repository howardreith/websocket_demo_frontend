(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{100:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(54),c=n.n(s),o=(n(65),n(12)),i=n(13),u=n(15),l=n(14),m=n(59),h=n(1),p=n(4),d=n(21),b=r.a.createContext(null,null);var f=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var a,r;return Object(o.a)(this,n),(a=t.call(this,e)).state=(r=Object(p.a)(a),{username:null,setUsername:function(e,t){r.setState((function(t){return Object(d.a)(Object(d.a)({},t),{},{username:e})}),t)}}),a}return Object(i.a)(n,[{key:"render",value:function(){var e=this.props.children;return r.a.createElement(b.Provider,{value:this.state},e)}}]),n}(a.Component),g=n(3),v=n.n(g),x=n(11);function y(e){return function(t){return r.a.createElement(b.Consumer,null,(function(n){return r.a.createElement(e,Object.assign({},t,{appContext:n}))}))}}var j=n(5),O=n.n(j),E=(O.a.shape({push:O.a.func}),O.a.shape({token:O.a.string,username:O.a.string,setToken:O.a.func,setUsername:O.a.func}),window.location.href.includes("localhost")?"http://localhost:8080":"https://reithwebsocketdemo.herokuapp.com");function k(e){return w.apply(this,arguments)}function w(){return(w=Object(x.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(E,"/signin"),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({username:t})});case 2:if(!(n=e.sent).ok){e.next=5;break}return e.abrupt("return",n.json().messages);case 5:throw Error("Username ".concat(t," already in use."));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(){return C.apply(this,arguments)}function C(){return(C=Object(x.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(E,"/last50messages"),{method:"get"});case 2:return t=e.sent,e.abrupt("return",t.json());case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var U,T,A,D,M,B=n(8),F=n(9),I=F.a.div(U||(U=Object(B.a)(["\n  margin: auto;\n  text-align: center;\n  width: 60%;\n"]))),K=F.a.h1(T||(T=Object(B.a)(['\n  font-family: "Arvo", serif;\n  font-size: 40px;\n']))),R=F.a.div(A||(A=Object(B.a)(["\n  margin: 10px auto;\n  text-align: center;\n"]))),_=F.a.input(D||(D=Object(B.a)(["\n  height: 30px;\n  width: 80%;\n  display: block;\n  margin: auto;\n  text-align: center;\n  font-size: 20px;\n"]))),H=F.a.button(M||(M=Object(B.a)(['\n  transition-duration: 0.4s;\n  background-color: white;\n  color: black;\n  border-color: gray;\n  height: 25px;\n  cursor: pointer;\n  margin: 2px;\n  font-family: "Lato", serif;\n']))),J=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).handleSubmitAsync=a.handleSubmitAsync.bind(Object(p.a)(a)),a.handleUsernameChange=a.handleUsernameChange.bind(Object(p.a)(a)),a.state={username:null},a}return Object(i.a)(n,[{key:"handleUsernameChange",value:function(e){var t=e.target.value;this.setState((function(e){return Object(d.a)(Object(d.a)({},e),{},{username:t})}))}},{key:"handleSubmitAsync",value:function(){var e=Object(x.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.state.username,t.preventDefault(),(0,this.props.onHandleSubmitUsername)(n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.error;return r.a.createElement(r.a.Fragment,null,r.a.createElement(I,null,r.a.createElement(K,null,"Choose a Username"),r.a.createElement("form",{"data-test-id":"usernameForm",id:"usernameForm",onSubmit:this.handleSubmitAsync},r.a.createElement(R,null,r.a.createElement(_,{type:"text",name:"username",id:"usernameInput",onChange:this.handleUsernameChange,placeholder:"Username","data-test-id":"usernameInput"})),r.a.createElement(H,{type:"submit",value:"submit",id:"usernameSubmitButton","data-test-id":"usernameSubmitButton"},"Submit")),e&&r.a.createElement("div",{id:"usernameInUseMessage","data-test-id":"usernameInUseMessage"},"Username already in use")))}}]),n}(a.Component),P=y(J);J.defaultProps={error:!1};var z,W,L,N,V,q=n(58),G=window.location.href.includes("localhost")?"http://localhost:8080":"https://reithwebsocketdemo.herokuapp.com",Q=Object(q.io)(G),X=F.a.div(z||(z=Object(B.a)(["\n  margin: 3px;\n  width: 99%;\n  border: 1px solid black;\n  height: 85vh;\n  overflow-y: scroll;\n"]))),Y=F.a.textarea(W||(W=Object(B.a)(["\n  margin: 3px;\n  width: 100%;\n  display: flex;\n  height: 30px;\n"]))),Z=F.a.input(L||(L=Object(B.a)(["\n  width: 70px;\n  height: 35px;\n  margin: 3px;\n"]))),$=F.a.form(N||(N=Object(B.a)(["\n  display: flex;\n"]))),ee=F.a.div(V||(V=Object(B.a)(["\n  height: 60px;\n  text-align: center;\n"]))),te=y(function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).handleMessageTextChange=a.handleMessageTextChange.bind(Object(p.a)(a)),a.handleSubmitAsync=a.handleSubmitAsync.bind(Object(p.a)(a)),a.onKeyDown=a.onKeyDown.bind(Object(p.a)(a)),a.state={messageText:"",messages:[]},a.messagesEndRef=r.a.createRef(),a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=Object(x.a)(v.a.mark((function e(){var t,n=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S();case 2:t=e.sent,this.setState({messages:t.messages.reverse()}),Q.on("receiveMessage",(function(e){var t=e.username,a=e.message,r=n.state.messages;r.push({messageSender:t,message:a}),n.setState({messages:r})}));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){this.scrollToBottom()}},{key:"handleMessageTextChange",value:function(e){var t=e.target.value;this.setState((function(e){return Object(d.a)(Object(d.a)({},e),{},{messageText:t})}))}},{key:"handleSubmitAsync",value:function(){var e=Object(x.a)(v.a.mark((function e(t){var n,a,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),n=this.state.messageText,a=this.props.appContext,r={username:a.username,message:n},Q.emit("message",r),this.setState({messageText:""});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onKeyDown",value:function(){var e=Object(x.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"!==t.key){e.next=5;break}return t.preventDefault(),t.stopPropagation(),e.next=5,this.handleSubmitAsync(t);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"scrollToBottom",value:function(){this.messagesEndRef.current.scrollIntoView({behavior:"smooth"})}},{key:"render",value:function(){var e=this.state,t=e.messageText,n=e.messages;return r.a.createElement("div",null,r.a.createElement(ee,null,r.a.createElement("h1",null,"Howie Chat")),r.a.createElement(X,{id:"mainChatWindow","data-test-id":"mainChatWindow"},n.map((function(e,t){return e&&e.message&&e.messageSender&&r.a.createElement("div",{key:"".concat(t,"wrapper").concat(e.message.replace(/\s/,""))},r.a.createElement("span",{key:"".concat(t,"sender").concat(e.message.replace(/\s/,""))},"".concat(e.messageSender,": ")),r.a.createElement("span",{key:"".concat(t,"message").concat(e.message.replace(/\s/,""))},e.message))})),r.a.createElement("div",{ref:this.messagesEndRef})),r.a.createElement($,{id:"chatTextForm","data-test-id":"chatTextForm",onSubmit:this.handleSubmitAsync},r.a.createElement(Y,{onKeyDown:this.onKeyDown,value:t,onChange:this.handleMessageTextChange,id:"messageTextBox","data-test-id":"messageTextBox"}),r.a.createElement(Z,{type:"submit",value:"send",id:"sendMessageButton"})))}}]),n}(a.Component)),ne=y(function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).handleSubmitUsername=a.handleSubmitUsername.bind(Object(p.a)(a)),a.setError=a.setError.bind(Object(p.a)(a)),a.state={error:void 0},a}return Object(i.a)(n,[{key:"handleSubmitUsername",value:function(){var e=Object(x.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.props.appContext,e.prev=1,e.next=4,k(t);case 4:this.setError(null),n.setUsername(t),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),this.setError(!0);case 11:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()},{key:"setError",value:function(e){this.setState({error:e})}},{key:"render",value:function(){var e=this.props.appContext,t=this.state.error;return r.a.createElement(r.a.Fragment,null,!e.username&&r.a.createElement(P,{onHandleSubmitUsername:this.handleSubmitUsername,error:t}),e.username&&r.a.createElement(te,null))}}]),n}(a.Component));var ae=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){return r.a.createElement(f,null,r.a.createElement(b.Consumer,null,(function(e){return e?r.a.createElement(r.a.Fragment,null,r.a.createElement(m.a,null,r.a.createElement(h.b,{exact:!0,path:"/"},r.a.createElement(h.a,{to:"/websocket_demo_frontend"})),r.a.createElement(h.b,{exact:!0,path:"/websocket_demo_frontend",render:function(e){return r.a.createElement(ne,e)}}))):r.a.createElement(r.a.Fragment,null)})))}}]),n}(a.Component);c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(ae,null)),document.getElementById("root"))},60:function(e,t,n){e.exports=n(100)},65:function(e,t,n){}},[[60,1,2]]]);
//# sourceMappingURL=main.f52fe958.chunk.js.map